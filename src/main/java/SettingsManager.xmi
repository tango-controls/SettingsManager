<?xml version="1.0" encoding="ASCII"?>
<pogoDsl:PogoSystem xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:pogoDsl="http://www.esrf.fr/tango/pogo/PogoDsl">
  <classes name="SettingsManager" pogoRevision="9.4">
    <description description="This idea is to standardize and centralize the settings management for the control system.&#xA;It will have to be accessible from client applications and servers written in C++, Java or Python.&#xA;&#xA;The most flexible system to store the settings is to use files on disk.&#xA;Users will be able to manage sub system, copies or edition (device/attribute renaming).&#xA;All settings files will be store under a $SETTINGS_ROOT directory.&#xA;A subdirectory will be created for each accelerator system.&#xA;To be accessible from all languages, a TANGO class will manage read, write and apply settings for attributes.&#xA;Each instance of this class will manage a system (SRRF, RIPS, LINAC, ...) files under its&#xA;own subdirectory fixed by a TANGO property.&#xA;This class will be able to:&#xA; - Write a settings file with an optional list of attribute as input argument. This class will be responsible&#xA;   to do not write above its subdirectory.&#xA; - Get file content to preview file with string as output argument.&#xA; - Apply settings to attributes.&#xA; - Read a settings file and return content in a pipe (att1 name, att1 value, att2 name, att2 value, ...)" title="Settings Manager" sourcePath="/mntdirect/_segfs/tango/jserver/SettingsManager/src/main/java" language="Java" filestogenerate="XMI   file,Code files,Protected Regions" license="GPL" copyright="Copyright (C): 2004,2005,2006,2007,2008,2009,2009,2010,2011,2012,2013,2014,2015&#xA;               European Synchrotron Radiation Facility&#xA;               BP 220, Grenoble 38043&#xA;               France" hasMandatoryProperty="false" hasConcreteProperty="true" hasAbstractCommand="false" hasAbstractAttribute="false">
      <inheritances classname="Device_Impl" sourcePath=""/>
      <identification contact="at esrf.fr - accelerator-control" author="accelerator-control" emailDomain="esrf.fr" classFamily="Archiving" siteSpecific="" platform="All Platforms" bus="Not Applicable" manufacturer="none" reference=""/>
    </description>
    <classProperties name="RootPath" description="Root path for all settings systems">
      <type xsi:type="pogoDsl:StringType"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </classProperties>
    <deviceProperties name="SettingsFilesPath" description="Path under the RootPath to read/write settings file.">
      <type xsi:type="pogoDsl:StringType"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </deviceProperties>
    <deviceProperties name="DefaultAttributeList" description="Default attribute list to generate settings file&#xA;if no attributes sent in WriteSettingsFile command">
      <type xsi:type="pogoDsl:StringVectorType"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </deviceProperties>
    <deviceProperties name="SettingsTimeout" description="timeout to write settings on specified devices in milliseconds.">
      <type xsi:type="pogoDsl:IntType"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <DefaultPropValue>3000</DefaultPropValue>
    </deviceProperties>
    <deviceProperties name="Debug" description="Add trace mode if true">
      <type xsi:type="pogoDsl:BooleanType"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <DefaultPropValue>false</DefaultPropValue>
    </deviceProperties>
    <deviceProperties name="UseAttributeFormat" description="Use attribute property format to write value in file if true.">
      <type xsi:type="pogoDsl:BooleanType"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <DefaultPropValue>true</DefaultPropValue>
    </deviceProperties>
    <commands name="State" description="This command gets the device state (stored in its device_state data member) and returns it to the caller." execMethod="dev_state" displayLevel="OPERATOR" polledPeriod="1000" isDynamic="false">
      <argin description="none">
        <type xsi:type="pogoDsl:VoidType"/>
      </argin>
      <argout description="Device state">
        <type xsi:type="pogoDsl:StateType"/>
      </argout>
      <status abstract="true" inherited="true" concrete="true" concreteHere="true"/>
    </commands>
    <commands name="Status" description="This command gets the device status (stored in its device_status data member) and returns it to the caller." execMethod="dev_status" displayLevel="OPERATOR" polledPeriod="0">
      <argin description="none">
        <type xsi:type="pogoDsl:VoidType"/>
      </argin>
      <argout description="Device status">
        <type xsi:type="pogoDsl:ConstStringType"/>
      </argout>
      <status abstract="true" inherited="true" concrete="true"/>
    </commands>
    <commands name="GetSettingsFileContent" description="read the specified file content" execMethod="get_settings_file_content" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="Specified file name.">
        <type xsi:type="pogoDsl:StringType"/>
      </argin>
      <argout description="The specified file content">
        <type xsi:type="pogoDsl:StringType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </commands>
    <commands name="GenerateSettingsFile" description="the device will generate a settings file for specified attributes" execMethod="generate_settings_file" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="This array must contain file name.&#xA;If no attributes are defined as property, it must contain attribute names.&#xA;It can also contain author names and comments.&#xA;Each element needs to start with:&#xA;FILE:            for file name&#xA;ATTRIBUTE:  for each attribute name&#xA;AUTHOR:      for author name&#xA;COMMENTS: for comments">
        <type xsi:type="pogoDsl:StringArrayType"/>
      </argin>
      <argout description="">
        <type xsi:type="pogoDsl:VoidType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <excludedStates>MOVING</excludedStates>
    </commands>
    <commands name="ApplySettings" description="Apply settings from specified file to attributes." execMethod="apply_settings" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="The specified file name">
        <type xsi:type="pogoDsl:StringType"/>
      </argin>
      <argout description="">
        <type xsi:type="pogoDsl:VoidType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <excludedStates>MOVING</excludedStates>
    </commands>
    <commands name="Reset" description="Reset ALARM state on device" execMethod="reset" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="">
        <type xsi:type="pogoDsl:VoidType"/>
      </argin>
      <argout description="">
        <type xsi:type="pogoDsl:VoidType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <excludedStates>MOVING</excludedStates>
    </commands>
    <commands name="FileExists" description="Check if specified file exists." execMethod="file_exists" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="File name">
        <type xsi:type="pogoDsl:StringType"/>
      </argin>
      <argout description="true if specified file exists, false otherwise">
        <type xsi:type="pogoDsl:BooleanType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </commands>
    <commands name="DeleteFile" description="Delete specified file." execMethod="delete_file" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="File name">
        <type xsi:type="pogoDsl:StringType"/>
      </argin>
      <argout description="">
        <type xsi:type="pogoDsl:VoidType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </commands>
    <commands name="RenameFile" description="Rename source file to target name." execMethod="rename_file" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="Source file name&#xA;Target file name">
        <type xsi:type="pogoDsl:StringArrayType"/>
      </argin>
      <argout description="">
        <type xsi:type="pogoDsl:VoidType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </commands>
    <commands name="GetFileList" description="Get the file and directory list in specified path." execMethod="get_file_list" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="Path to be added to the project path&#xA;e.g.: ````, ``.``, ``sav``, ``old``,.....">
        <type xsi:type="pogoDsl:StringType"/>
      </argin>
      <argout description="FILE:  or DIR:  followed by file or directory name">
        <type xsi:type="pogoDsl:StringArrayType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </commands>
    <commands name="MakeDirectory" description="Created the specified directory" execMethod="make_directory" displayLevel="OPERATOR" polledPeriod="0" isDynamic="false">
      <argin description="Directory name (relative to project path)">
        <type xsi:type="pogoDsl:StringType"/>
      </argin>
      <argout description="">
        <type xsi:type="pogoDsl:VoidType"/>
      </argout>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </commands>
    <attributes name="SettingsPath" attType="Scalar" rwType="READ" displayLevel="OPERATOR" polledPeriod="1000" maxX="" maxY="" allocReadMember="true" isDynamic="false">
      <dataType xsi:type="pogoDsl:StringType"/>
      <changeEvent fire="false" libCheckCriteria="false"/>
      <archiveEvent fire="false" libCheckCriteria="false"/>
      <dataReadyEvent fire="false" libCheckCriteria="true"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <properties description="Path where settings files are read and write." label="Settings path" unit="" standardUnit="" displayUnit="" format="" maxValue="" minValue="" maxAlarm="" minAlarm="" maxWarning="" minWarning="" deltaTime="" deltaValue=""/>
    </attributes>
    <attributes name="LastGeneratedFile" attType="Scalar" rwType="READ" displayLevel="OPERATOR" polledPeriod="1000" maxX="" maxY="" allocReadMember="true" isDynamic="false">
      <dataType xsi:type="pogoDsl:StringType"/>
      <changeEvent fire="false" libCheckCriteria="false"/>
      <archiveEvent fire="false" libCheckCriteria="false"/>
      <dataReadyEvent fire="false" libCheckCriteria="true"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <properties description="" label="Last generated file" unit="" standardUnit="" displayUnit="" format="" maxValue="" minValue="" maxAlarm="" minAlarm="" maxWarning="" minWarning="" deltaTime="" deltaValue=""/>
    </attributes>
    <attributes name="LastAppliedFile" attType="Scalar" rwType="READ" displayLevel="OPERATOR" polledPeriod="1000" maxX="" maxY="" allocReadMember="true" isDynamic="false">
      <dataType xsi:type="pogoDsl:StringType"/>
      <changeEvent fire="false" libCheckCriteria="false"/>
      <archiveEvent fire="false" libCheckCriteria="false"/>
      <dataReadyEvent fire="false" libCheckCriteria="true"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <properties description="" label="Last applied file" unit="" standardUnit="" displayUnit="" format="" maxValue="" minValue="" maxAlarm="" minAlarm="" maxWarning="" minWarning="" deltaTime="" deltaValue=""/>
    </attributes>
    <attributes name="CheckChangePeriod" attType="Scalar" rwType="READ_WRITE" displayLevel="OPERATOR" polledPeriod="1000" maxX="" maxY="" memorized="true" memorizedAtInit="true" allocReadMember="true" isDynamic="false">
      <dataType xsi:type="pogoDsl:IntType"/>
      <changeEvent fire="false" libCheckCriteria="false"/>
      <archiveEvent fire="false" libCheckCriteria="false"/>
      <dataReadyEvent fire="false" libCheckCriteria="true"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <properties description="Period (in seconds) to check if settings have change since last appalied." label="Check Change Period" unit="sec." standardUnit="" displayUnit="" format="" maxValue="300" minValue="1" maxAlarm="" minAlarm="" maxWarning="" minWarning="" deltaTime="" deltaValue=""/>
      <eventCriteria relChange="" absChange="1" period=""/>
    </attributes>
    <attributes name="DefaultAttributes" attType="Spectrum" rwType="READ" displayLevel="OPERATOR" polledPeriod="1000" maxX="512" maxY="" allocReadMember="true" isDynamic="false">
      <dataType xsi:type="pogoDsl:StringType"/>
      <changeEvent fire="false" libCheckCriteria="false"/>
      <archiveEvent fire="false" libCheckCriteria="false"/>
      <dataReadyEvent fire="false" libCheckCriteria="true"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <properties description="The default attribute list from property." label="" unit="" standardUnit="" displayUnit="" format="" maxValue="" minValue="" maxAlarm="" minAlarm="" maxWarning="" minWarning="" deltaTime="" deltaValue=""/>
    </attributes>
    <attributes name="AlarmAttributes" attType="Spectrum" rwType="READ" displayLevel="OPERATOR" polledPeriod="1000" maxX="512" maxY="" allocReadMember="true" isDynamic="false">
      <dataType xsi:type="pogoDsl:StringType"/>
      <changeEvent fire="false" libCheckCriteria="false"/>
      <archiveEvent fire="false" libCheckCriteria="false"/>
      <dataReadyEvent fire="false" libCheckCriteria="true"/>
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
      <properties description="List of attributes in ALARM" label="Alarm attributes" unit="" standardUnit="" displayUnit="" format="" maxValue="" minValue="" maxAlarm="" minAlarm="" maxWarning="" minWarning="" deltaTime="" deltaValue=""/>
    </attributes>
    <pipes name="SettingValues" description="Returns the attributes with their values (setpoints)." label="Setting Values" rwType="READ" displayLevel="OPERATOR"/>
    <pipes name="LastAppliedFileContent" description="Returns last applied file content" label="Last applied file content" rwType="READ" displayLevel="OPERATOR"/>
    <states name="ON" description="The device is ready to apply settings.">
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </states>
    <states name="ALARM" description="The device has applied settings, but at least one attribute apply has failed.&#xA;Or Settings have been applied but changed by someone.">
      <status abstract="false" inherited="false" concrete="true" concreteHere="true"/>
    </states>
    <preferences docHome="./doc_html" makefileHome="/segfs/tango/cppserver/env"/>
  </classes>
</pogoDsl:PogoSystem>
